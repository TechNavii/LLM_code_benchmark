[pytest]
testpaths = tests harness/tests
asyncio_mode = auto
asyncio_default_fixture_loop_scope = function
pythonpath = .

# Custom markers for special test categories
markers =
    gui: GUI headless browser tests (require Playwright browsers)

# Coverage configuration
# Note: GUI tests are excluded by default because they require Playwright browsers
# Run GUI tests separately with: pytest -m gui tests/test_gui_smoke.py
addopts = --cov=server --cov=harness --cov-report=term-missing --cov-report=html --cov-report=xml --junit-xml=junit.xml --cov-fail-under=24 -m "not gui"
# Baseline set to 24% to match current coverage for brownfield project
# This prevents coverage regression while allowing incremental improvement
# Coverage will be tracked in htmlcov/ directory
# JUnit XML report will be generated for CI artifact upload and PR annotations
# Coverage XML report will be generated for advanced coverage analysis in CI

# Warning filters - CI adds stricter filters via -W flags
# Local development allows warnings to pass through while CI is strict
# CI enforces: -W error::DeprecationWarning -W error::PendingDeprecationWarning -W error::RuntimeWarning -W error::ResourceWarning
filterwarnings =
    # Ignore specific third-party library warnings that we cannot fix
    # Add new entries here with justification when whitelisting unavoidable warnings
    # Format: ignore::WarningType:module_pattern:line_number
    #
    # Example (uncomment if needed):
    # ignore::DeprecationWarning:some_third_party_lib.*